<h1> Make a reservation </h1>

<section>
Booking dates: <%= @checkin %> to <%= @checkout %><br>
Number of guests: <%= @group_size %>
</section>

<section>
<%= form_tag bookings_path do %>
  <% @rooms.each do |room| %>
    <% if room.bookings != [] %>
      <% room.bookings.each do |booking| %>
        <% if !booking.date_range.overlaps?(@date_range) && room.capacity >= @group_size.to_i %>
            <h3>Room <%= room.room_number %> <%= check_box_tag :'booking[room_id]', room.id %></h3>
            <ul>
              <li>Sleeps <%= room.capacity %> guests</li>
              <li>$<%= room.cost %> per night</li>
            </ul>
        <% end %>
      <% end %>
    <% elsif room.bookings == [] && room.capacity >= @group_size %>
      <h3>Room <%= room.room_number %> <%= check_box_tag :'booking[room_id]', room.id %></h3>
      <ul>
        <li>Sleeps <%= room.capacity %> guests</li>
        <li>$<%= room.cost %> per night</li>
      </ul>
    <% end %>
  <% end %>
<%= hidden_field_tag :'booking[user_id]', session[:user_id] %>
<%= hidden_field_tag :'booking[group_size]', @group_size %>
<%= hidden_field_tag :'booking[checkin]', @checkin %>
<%= hidden_field_tag :'booking[checkout]', @checkout %>
<%= submit_tag "Book this room" %>
<% end %>
</section>

<br>

<section>
<%= link_to "Back to home screen", user_path(@user)%><br>
<%= link_to "Log out", signout_path %>
</section>
